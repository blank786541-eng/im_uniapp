import{d as e,g as t,h as s,j as a,o as i,a as o,e as n,u as l,k as c,t as r,p as u,E as v,b as p,aC as d}from"./index-CA_4_S1o.js";import{N as m}from"./NavBar.B_pGq4kd.js";import{A as I}from"./Avatar.cDMQ39ID.js";import{I as M}from"./Icon.DO2Wg01x.js";import{b as C}from"./uni-app.es.f5Xd5cz1.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";const T=S(e({__name:"p2p-set",setup(e){var S,T;const _=t(""),g=t(),k=t(!1),x=t(!1),U=t(""),h=t("");let N;const $=null==(T=null==(S=uni.$UIKitStore)?void 0:S.sdkOptions)?void 0:T.enableV2CloudConversation;C(e=>{const t=null==e?void 0:e.id;U.value=t;const a=uni.$UIKitNIM.V2NIMConversationIdUtil.p2pConversationId(t);h.value=a,N=s(()=>{var e,s,i;g.value=$?null==(e=uni.$UIKitStore.conversationStore)?void 0:e.conversations.get(a):null==(s=uni.$UIKitStore.localConversationStore)?void 0:s.conversations.get(a),_.value=uni.$UIKitStore.uiStore.getAppellation({account:t}),k.value=uni.$UIKitStore.relationStore.mutes.includes(t),x.value=!!(null==(i=g.value)?void 0:i.stickTop)})});const f=()=>{const e=uni.$UIKitNIM.V2NIMConversationIdUtil.parseConversationTargetId(h.value);u({url:`/pages/Team/team-create/index?p2pConversationId=${e}`})},j=()=>{u({url:`/pages/Chat/message/pin-list?conversationId=${h.value}`})},K=()=>{u({url:`/pages/Chat/message/add-note?conversationId=${U.value}`})},P=async e=>{const t=!e.detail.value;try{await uni.$UIKitStore.relationStore.setP2PMessageMuteModeActive(U.value,t?v.V2NIMP2PMessageMuteMode.V2NIM_P2P_MESSAGE_MUTE_MODE_ON:v.V2NIMP2PMessageMuteMode.V2NIM_P2P_MESSAGE_MUTE_MODE_OFF)}catch(s){uni.showToast({title:p(t?"sessionMuteFailText":"sessionUnMuteFailText"),icon:"error"})}},b=async e=>{var t,s;const a=e.detail.value;try{$?await(null==(t=uni.$UIKitStore.conversationStore)?void 0:t.stickTopConversationActive(h.value,a)):await(null==(s=uni.$UIKitStore.localConversationStore)?void 0:s.stickTopConversationActive(h.value,a))}catch(i){uni.showToast({title:p(a?"addStickTopFailText":"deleteStickTopFailText"),icon:"error"})}};return a(()=>{N()}),(e,t)=>{const s=d;return i(),o("div",null,[n(m,{title:l(p)("setText")},null,8,["title"]),c("div",{class:"p2p-set-container"},[c("div",{class:"p2p-set-card"},[c("div",{class:"p2p-set-item"},[c("div",{class:"p2p-set-my-info"},[n(I,{account:U.value},null,8,["account"]),c("div",{class:"p2p-set-my-nick"},r(_.value),1)]),c("div",{class:"member-add",onClick:f},[n(M,{type:"icon-tianjiaanniu"})])])]),c("div",{class:"p2p-set-card"},[c("div",{class:"p2p-set-item p2p-set-item-flex-sb",onClick:K},[c("div",null,"备注"),n(M,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})]),c("div",{class:"p2p-set-item p2p-set-item-flex-sb",onClick:j},[c("div",null,r(l(p)("pinText")),1),n(M,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})]),c("div",{class:"p2p-set-item p2p-set-item-flex-sb"},[c("div",null,r(l(p)("sessionMuteText")),1),n(s,{checked:!k.value,onChange:P},null,8,["checked"])]),c("div",{class:"p2p-set-item p2p-set-item-flex-sb"},[c("div",null,r(l(p)("stickTopText")),1),n(s,{checked:x.value,onChange:b},null,8,["checked"])])])])])}}}),[["__scopeId","data-v-b279c91e"]]);export{T as default};
