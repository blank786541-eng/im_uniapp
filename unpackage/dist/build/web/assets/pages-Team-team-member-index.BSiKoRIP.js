import{d as e,g as t,c as a,h as o,j as r,o as m,a as s,e as n,u as i,k as l,t as u,f as c,F as M,r as d,l as I,p as _,b as v,E,aE as R}from"./index-CA_4_S1o.js";import{A as T}from"./Avatar.cDMQ39ID.js";import{N}from"./NavBar.B_pGq4kd.js";import{b}from"./uni-app.es.f5Xd5cz1.js";import{_ as p}from"./Appellation.vue_vue_type_script_setup_true_lang.Bn2FxhVA.js";import{I as A}from"./Icon.DO2Wg01x.js";import{E as V}from"./Empty.DhhBt1kg.js";import{_ as f}from"./_plugin-vue_export-helper.BCo6x5W8.js";const x=f(e({__name:"index",setup(e){const f=t([]),x=t();let y="";t(!1),t(!1);const g=a(()=>{var e;let t=null==(e=x.value)?void 0:e.serverExtension;return R(t)}),h=()=>{_({url:`/pages/Team/team-add/index?teamId=${y}`})},O=a(()=>{const e=uni.$UIKitStore.userStore.myUserInfo;return(x.value?x.value.ownerAccountId:"")===(e?e.accountId:"")}),S=a(()=>{const e=uni.$UIKitStore.userStore.myUserInfo;return f.value.filter(e=>e.memberRole===E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER).some(t=>t.accountId===(e?e.accountId:""))}),j=a(()=>{var e;return(null==(e=x.value)?void 0:e.inviteMode)===E.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_ALL||(O.value||S.value)}),k=e=>!g.value&&(e.accountId!==uni.$UIKitStore.userStore.myUserInfo.accountId&&(!!O.value||!!S.value&&(e.memberRole!==E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER&&e.memberRole!==E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER)));let B=()=>{};return b(e=>{y=e?e.teamId:"",B=o(()=>{x.value=uni.$UIKitStore.teamStore.teams.get(y);var e;f.value=[...(e=uni.$UIKitStore.teamMemberStore.getTeamMember(y)).filter(e=>e.memberRole===E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER),...e.filter(e=>e.memberRole===E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER).sort((e,t)=>e.joinTime-t.joinTime),...e.filter(e=>![E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER,E.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER].includes(e.memberRole)).sort((e,t)=>e.joinTime-t.joinTime)]})}),r(()=>{B()}),(e,t)=>(m(),s("div",null,[n(N,{title:g.value?i(v)("discussionMemberText"):i(v)("teamMemberText")},null,8,["title"]),j.value?(m(),s("div",{key:0,class:"add-item",onClick:h},[l("span",{class:"add-item-label"},u(i(v)("addMemberText")),1),n(A,{color:"#999",type:"icon-jiantou"})])):c("",!0),f.value.length?(m(),s("div",{key:1},[(m(!0),s(M,null,d(f.value,e=>(m(),s("div",{class:"group-item",key:e.accountId},[l("div",{class:"group-member"},[n(T,{"goto-user-card":!0,account:e.accountId,"team-id":e.teamId,size:"32"},null,8,["account","team-id"]),n(p,{class:"user-name",account:e.accountId,"team-id":e.teamId,"font-size":14},null,8,["account","team-id"]),e.memberRole!==i(E).V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_OWNER||g.value?e.memberRole!==i(E).V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER||g.value?c("",!0):(m(),s("div",{key:1,class:"user-tag"},u(i(v)("manager")),1)):(m(),s("div",{key:0,class:"user-tag"},u(i(v)("teamOwner")),1))]),k(e)?(m(),s("div",{key:0,class:"btn-remove",style:{"margin-right":"10px"},onClick:()=>{(async e=>{try{await uni.$UIKitNIM.V2NIMTeamService.setTeamMemberChatBannedStatus(e.teamId,e.teamType,e.accountId,!e.chatBanned)}catch(t){uni.showToast({title:t.message,icon:"error"})}})(e)}},u(e.chatBanned?"解除禁言":"禁言"),9,["onClick"])):c("",!0),k(e)?(m(),s("div",{key:1,class:"btn-remove",onClick:()=>{var t;t=e.accountId,uni.showModal({title:v("confirmRemoveText"),content:v("removeMemberExplain"),confirmText:v("removeText"),success:e=>{e.cancel||uni.$UIKitStore.teamMemberStore.removeTeamMemberActive({teamId:y,accounts:[t]}).then(()=>{uni.showToast({title:v("removeSuccessText"),icon:"none"})}).catch(e=>{109306===(null==e?void 0:e.code)?uni.showToast({title:v("noPermission"),icon:"error"}):uni.showToast({title:v("removeFailText"),icon:"error"})})}})}},u(i(v)("removeText")),9,["onClick"])):c("",!0)]))),128))])):(m(),I(V,{key:2,text:i(v)("noTeamMember")},null,8,["text"]))]))}}),[["__scopeId","data-v-40603067"]]);export{x as default};
