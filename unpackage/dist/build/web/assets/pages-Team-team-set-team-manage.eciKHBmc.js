import{d as e,g as a,c as t,h as l,j as n,o,a as i,e as s,u as r,k as m,t as u,v,f as d,b as M,a4 as c,E as I,p as _,aS as T}from"./index-CA_4_S1o.js";import{N}from"./NavBar.B_pGq4kd.js";import{I as E}from"./Icon.DO2Wg01x.js";import{b as A}from"./uni-app.es.f5Xd5cz1.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";const f=p(e({__name:"team-manage",setup(e){const p=[M("teamAll"),M("teamOwnerAndManagerText")];let f="";const x=a(),g=a([]),V=t(()=>{const e=uni.$UIKitStore.userStore.myUserInfo;return(x.value?x.value.ownerAccountId:"")===(e?e.accountId:"")}),O=t(()=>g.value.filter(e=>e.memberRole===I.V2NIMTeamMemberRole.V2NIM_TEAM_MEMBER_ROLE_MANAGER).length),b=t(()=>{var e,a;return{value:(null==(e=x.value)?void 0:e.updateInfoMode)===I.V2NIMTeamUpdateInfoMode.V2NIM_TEAM_UPDATE_INFO_MODE_MANAGER?1:0,text:(null==(a=x.value)?void 0:a.updateInfoMode)===I.V2NIMTeamUpdateInfoMode.V2NIM_TEAM_UPDATE_INFO_MODE_MANAGER?M("teamOwnerAndManagerText"):M("teamAll")}}),S=t(()=>{var e,a;return{value:(null==(e=x.value)?void 0:e.inviteMode)===I.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_MANAGER?1:0,text:(null==(a=x.value)?void 0:a.inviteMode)===I.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_MANAGER?M("teamOwnerAndManagerText"):M("teamAll")}}),U=t(()=>{var e;let a={};try{a=JSON.parse((null==(e=x.value)?void 0:e.serverExtension)||"{}")}catch(t){}return{value:"manager"===a[c]?1:0,text:"manager"===a[c]?M("teamOwnerAndManagerText"):M("teamAll")}}),h=e=>{R("updateInfoMode",0==e.detail.value?"all":"manager")},y=e=>{R("inviteMode",0==e.detail.value?"all":"manager")},D=e=>{R("serverExtension",0==e.detail.value?"all":"manager")},R=async(e,a)=>{var t;const l={teamId:f};switch(e){case"updateInfoMode":l.updateInfoMode="all"===a?I.V2NIMTeamUpdateInfoMode.V2NIM_TEAM_UPDATE_INFO_MODE_ALL:I.V2NIMTeamUpdateInfoMode.V2NIM_TEAM_UPDATE_INFO_MODE_MANAGER;break;case"inviteMode":l.inviteMode="all"===a?I.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_ALL:I.V2NIMTeamInviteMode.V2NIM_TEAM_INVITE_MODE_MANAGER;break;case"serverExtension":{let e={};try{e=JSON.parse((null==(t=x.value)?void 0:t.serverExtension)||"{}")}catch(n){}e[c]=a,l.serverExtension=JSON.stringify(e);break}}try{await uni.$UIKitStore.teamStore.updateTeamActive({teamId:f,info:l})}catch(n){if(109432===(null==n?void 0:n.code))uni.showToast({title:M("noPermission"),icon:"error"});else uni.showToast({title:M("updateTeamFailedText"),icon:"error"})}},j=()=>{_({url:`/pages/Team/team-set/transform-team?id=${f}`})},w=()=>{_({url:`/pages/Team/team-set/team-manager-list?id=${f}`})};return A(e=>{f=e?e.id:"",l(()=>{f&&(x.value=uni.$UIKitStore.teamStore.teams.get(f),g.value=uni.$UIKitStore.teamMemberStore.getTeamMember(f))})}),n(()=>{}),(e,a)=>{const t=T;return o(),i("div",null,[s(N,{title:r(M)("teamManagerText")},null,8,["title"]),x.value?(o(),i("div",{key:0,class:"team-set-container"},[m("div",{class:"team-set-card"},[m("div",{class:"team-set-item"},[m("div",{class:"team-members-info-item",onClick:w},[m("div",{class:"team-members-info"},[m("div",{class:"team-info-title"},u(r(M)("teamManagerSettingText")),1),m("div",{class:"team-info-subtitle"},u(O.value),1)]),s(E,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})])])]),m("div",{class:"team-set-card"},[s(t,{onChange:h,value:b.value.value,range:p},{default:v(()=>[m("div",{class:"team-set-item team-set-item-flex"},[m("div",null,[m("div",null,u(r(M)("updateTeamInfoText")),1),m("div",{class:"team-item-value-text"},u(b.value.text),1)]),s(E,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})])]),_:1},8,["value"]),s(t,{onChange:y,value:S.value.value,range:p},{default:v(()=>[m("div",{class:"team-set-item team-set-item-flex"},[m("div",null,[m("div",null,u(r(M)("updateTeamInviteText")),1),m("div",{class:"team-item-value-text"},u(S.value.text),1)]),s(E,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})])]),_:1},8,["value"]),s(t,{onChange:D,value:U.value.value,range:p},{default:v(()=>[m("div",{class:"team-set-item team-set-item-flex"},[m("div",null,[m("div",null,u(r(M)("updateTeamAtText")),1),m("div",{class:"team-item-value-text"},u(U.value.text),1)]),s(E,{iconClassName:"more-icon",color:"#999",type:"icon-jiantou"})])]),_:1},8,["value"])]),V.value?(o(),i("div",{key:0,class:"group-set-button",onClick:j},u(r(M)("transformTeam")),1)):d("",!0)])):d("",!0)])}}}),[["__scopeId","data-v-3c208be4"]]);export{f as default};
